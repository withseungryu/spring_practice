
# 1장 

## 1. 초난감 DAO 코드
https://withseungryu.tistory.com/66

### 👉 Database와 연동하기 위해 JDBC를 사용할 것인데, 일반적인 순서는 아래와 같습니다.


* DB 연결을 위한 Connection을 가져온다.
* SQL을 담은 Statement(or PreparedStatement)를 만든다.
* 만들어진 Statement를 실행한다.
* 조회의 경우 SQL 쿼리의 실행 결과를 ResultSet으로 받아서 정보를 저장할 오브젝트(User)에 옮겨준다.
* 작업 중에 생성된 Connection, Statement, ResultSet 같은 리소스는 작업을 마친 후 반드시 닫아준다.
* JDBC API가 만들어내는 예외를 잡아서 직접 처리하거나, throws를 선언해 예외가 발생하면 메서드 밖으로 던지게 한다.

### 🧾 정리 

지금까지 간단한 DAO코드를 만들어 보았습니다.

하지만 이 DAO 클래스에는 객체지향 설계 원칙(SOLID)들 중 개방 폐쇄 원칙에 만족하지 못하고 있습니다.



개방 폐쇠 원칙이란?

 '클래스나 모듈은 확장에는 열려 있어야 하고 변경에는 닫혀 있어야 한다'



즉, 이 Dao 클래스를 다양한 클라이언트들이 사용할 텐데,,,,

모든 클라이언트들이 다 같은 DB connect 방식을 사용하지 않을 것입니다.



만약 모든 클라이언트들의 DB connect 방식이 다르다면, 매번 Dao 객체를 고쳐주어야 할 것입니다.



하지만 대부분의 개발자들은 고객에게 소스를 직접 공개하고 싶지 않아 하기 때문에,

클라이언트들이 원하는 DB connection 방식을 아래와 같이 요구에 맞게 생성해줘야 합니다.






## 2. 관심사의 분리

#### 🧐 분리란?
 

프로그래밍의 기초 개념 중 관심사의 분리라는 게 있는데,

 

이를 객체지향에 적용해보면, 관심이 같은 것끼리는 하나의 객체 안으로 또는 친한 객체로 모이게 할 수 있고,

관심이 다른 것은 가능한 한 따로 떨어져서 서로 영향을 주지 않도록 분리하는 것입니다.


#### 👉 템플릿 메소드 패턴 - 스프링이 사랑하는..

 

 슈퍼클래스에 기본적인 로직의 흐름을 만들고, 

 그 기능의 일부를 추상 메소드로 만든 뒤 서브클래스에서 이런 메소드를 필요에 맞게 구현해서

 사용하도록 만드는 방법을 템플릿 메소드 패턴이라고 합니다.
 
### 🧾 정리  (Commit 코드 참조)

분리를 통해 그럴듯한 Dao 객체를 만들어주었습니다.

 

하지만, 아쉽게도 문제점은 남아있습니다.

상속은 다중 상속을 허용하지 않기 때문에 다른 목적으로 UserDao에 상속을 적용하기 힘듭니다.

확장된 기능인 DB Connection을 생성하는 코드를 다른 Dao 클래스에서 적용 할 수 없습니다.

 

이를 위해 DAO에 확장을 적용해야합니다.


## 3. 확장

인터페이스 도입

 

위 문제를 해결하기 위해 상속 대신 인터페이스를 도입해 확장을 해야합니다.

 

#### 💡 인터페이스란?

 '자바가 추상화를 위해 제공하는 가장 유용한 도구' , '어떤 일을 하겠다는 기능만 정의해놓은 코드'

 

인터페이스를 통해 UserDao와 ConnectionMaker간의 서로 긴밀하게 연결되어 있지 않도록 중간에 추상적인 느슨한 연결고리를 만들어줄 수 있습니다.


#### 관계 설정 책임의 분리

 

기존 UserDao의 관심사가 아닌 부분을 서버 부분이 아닌 클라이언트 부분으로 분리를 해주는 것입니다.

즉, 클라이언트 부분에서 UserDao와 관심사가 아닌 부분 간의 오브젝트(객체) 관계를 설정해주는 것입니다.

 

이것이 가능한 이유는 코드에서는 특정 클래스를 전혀 알지 못하더라도 해당 클래스가 구현한 인터페이스를 사용했다면, 그 클래스의 오브젝트를 인터페이스 타입으로 받아서 사용할 수 있기 때문입니다.

 

따라서 두 오브젝트 사이에 런타임 사용관계 또는 링크, 또는 의존관계라고 불리는 관계를 맺어주면 됩니다.


### 🧾 정리 
 

이렇게 만들어진 UserDaoTest - UserDao - ConnectionMaker 구조를

디자인 패턴의 시각으로 전략 패턴(Strategy Pattern)이라 할 수 있습니다.

 

#### 💡 전략 패턴이란?

 

 디자인 패턴의 꼿이라고 불릴 만큼 다양하게 사용되며, 개방 폐쇄 원칙의 실현에도 가장 잘 들어 맞는 패턴입니다.

 전략 패턴은 자신의 기능 맥락에서, 필요에 따라 변경이 필요한 알고리즘을 인터페이스를 통해 외부로 분리시키고,

 이를 구현한 구체적인 알고리즘 클래스를 필요에 따라 바꿔서 사용할 수 있게 하는 디자인 패턴입니다.
 
 
 
 
## 4. 오브젝트 팩토리
 
 
#### 💡 팩토리

 

분리시킬 기능을 담당할 클래스를 만들기 위해,

이 클래스는 객체의 생성 방법을 결정하고 그렇게 만들어진 오브젝트를 돌려주는 것인데,

이 클래스를 팩토리라고 부릅니다.

 

주의해야할 점은 추상 팩토리 패턴이나 팩토리 메소드 패턴과는 다르다는 것을 인지해야합니다.

 

이제 팩토리 클래스의 역할을 하는 DaoFactory 클래스를 만들어보겠습니다.







 
 

